# Lab 9 - AshJsonApi

## Relevant Documentation

- [AshJsonApi Docs](https://hexdocs.pm/ash_json_api/getting-started-with-json-api.html)

## Existing Setup

- JSON API router created
- Domain configured with `prefix`

## Steps

1. Add `AshJsonApi.Resource` to the extensions to `Twitter.Tweets.Tweet`

```bash
mix ash.patch.extend Twitter.Tweets.Tweet json_api
```

2. Add an `index` route

```elixir
json_api do
  type "tweet"

  routes do
    base "/tweets"

    index :feed
  end
end
```

7. Visit `localhost:4000/api/json/tweets`. You might notice that the `attributes` key is empty. This is because we haven't marked any of our attributes is `public?`.

For an API extension to show any attributes, calculations, they must be marked `public?`. Add the `public? true` option to the attributes on the `tweet`.

8. You'll notice also that the `links` are empty. We can add a `get` route for to fetch a tweet.

```elixir
get :read, primary?: true
```

This `primary? true` causes the `links` to use this route as the `self` link for any given tweet.

### Try on your own

- Try out the api at `localhost:4000/api/json/tweets`
- Check out the swagger docs at `localhost:4000/api/json/swaggerui`
- Check out the redoc docs at `localhost:4000/api/json/redoc`
- Add a `description` to one of the attributes to see how it populates in the autogenerated documentation.
- Add a `description` to the action, and to the resource as well.

**_TIP_**: For resources, the `description` is added inside of the `resource` block.

```elixir
resource do
  description "your_description"
end
```
